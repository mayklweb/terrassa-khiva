<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style/main.css" />
    <title>Terrassa Khiva | Terrassa Restaurant & Cafe</title>
  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <div class="container">
          <div class="header-row">
            <div class="header-logo">
              <img src="./public/logo.png" alt="" />
            </div>
            <div class="header-action">
              <a class="header-link" href="./menu.html">MENU</a>
              <button class="header-btn">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  stroke="#ffffff"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <line x1="4" x2="20" y1="12" y2="12" />
                  <line x1="4" x2="20" y1="6" y2="6" />
                  <line x1="4" x2="20" y1="18" y2="18" />
                </svg>
              </button>
            </div>
          </div>
        </div>
      </header>
      <main class="main">
        <div id="progress"></div>
      </main>
      <footer class="footer"></footer>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r105/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/panolens@0.12.0/build/panolens.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/18.6.4/tween.umd.min.js"></script>

    <script type="module">
     

      // function changePanorama() {
      //   let currentPanorama = viewer.panorama;

      //   // Smooth fade-out effect (1.5s)
      //   new TWEEN.Tween(viewer.panorama.material)
      //     .to({ opacity: 0 }, 1500)
      //     .onComplete(() => {
      //       setTimeout(() => {
      //         // Add 1s delay before switching
      //         if (currentPanorama === panorama15) {
      //           viewer.setPanorama(panorama16);
      //         } else {
      //           viewer.setPanorama(panorama15);
      //         }

      //         // Smooth fade-in effect (1.5s)
      //         new TWEEN.Tween(viewer.panorama.material)
      //           .to({ opacity: 1 }, 1500)
      //           .start();
      //       }, 1000);
      //     })
      //     .start();
      // }

      // function startAutoSwitch() {
      //   interval = setInterval(changePanorama, 7000); // Change every 7s instead of 5s
      // }

      // function stopAutoSwitch() {
      //   clearInterval(interval);
      // }

      // // Preload images to avoid black screen
      // panorama15.addEventListener("load", () => {
      //   panorama16.load();
      // });

      // // Start auto-switching only when user enters panorama15
      // panorama15.addEventListener("enter", startAutoSwitch);

      // // Stop auto-switching if user leaves panorama15
      // viewer.container.addEventListener("click", () => {
      //   if (viewer.panorama !== panorama15 && viewer.panorama !== panorama16) {
      //     stopAutoSwitch();
      //   }
      // });

      // // Ensure animations work
      // function animate() {
      //   requestAnimationFrame(animate);
      //   TWEEN.update();
      // }
      // animate();
    </script>

    <!-- <script type="module">
      const viewer = new PANOLENS.Viewer();
      let panorama1 = new PANOLENS.ImagePanorama("media/1.webp");
      let panorama2 = new PANOLENS.ImagePanorama("media/2.webp");

      viewer.add(panorama1);
      viewer.add(panorama2);

      function transitionPanorama(newPanorama) {
        let fov = { value: viewer.camera.fov }; // Hozirgi FOV
        let opacity = { value: 1 };

        // Zoom-in effekti
        new TWEEN.Tween(fov)
          .to({ value: 30 }, 800) // Kichik fov -> Zoom-in
          .onUpdate(() => {
            viewer.camera.fov = fov.value;
            viewer.camera.updateProjectionMatrix();
          })
          .start();

        // Fade-out effekti
        new TWEEN.Tween(opacity)
          .to({ value: 0.5 }, 800)
          .onUpdate(() => {
            viewer.panorama.material.opacity = opacity.value;
          })
          .onComplete(() => {
            viewer.setPanorama(newPanorama);

            // Fade-in va Zoom-out (normal holatga qaytish)
            new TWEEN.Tween(opacity)
              .to({ value: 1 }, 800)
              .onUpdate(() => {
                viewer.panorama.material.opacity = opacity.value;
              })
              .start();

            new TWEEN.Tween(fov)
              .to({ value: 70 }, 800) // Katta fov -> Zoom-out
              .onUpdate(() => {
                viewer.camera.fov = fov.value;
                viewer.camera.updateProjectionMatrix();
              })
              .start();
          })
          .start();
      }

      // Har safar bosilganda rasm oâ€˜zgarishi va effekt bajarilishi
      document.addEventListener("click", function () {
        transitionPanorama(
          viewer.panorama === panorama1 ? panorama2 : panorama1
        );
      });

      // Animate qilish kerak
      function animate() {
        requestAnimationFrame(animate);
        TWEEN.update();
      }
      animate();
    </script> -->
  </body>
</html>
